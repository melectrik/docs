<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Cache &mdash; ViUR Server 1.1.0 documentation</title>
    
    <link rel="stylesheet" href="_static/mbtemplate.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    './',
        VERSION:     '1.1.0',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <link rel="top" title="ViUR Server 1.1.0 documentation" href="index.html" />
    <link rel="next" title="Configuration" href="config.html" />
    <link rel="prev" title="server" href="server_api.html" />
   
  
  <link rel="icon" href="_static/favicon.png" type="image/png"/>
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head>
  <body role="document">  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="cache">
<h1>Cache<a class="headerlink" href="#cache" title="Permalink to this headline">¶</a></h1>
<p>ViUR provides an built-in caching-mechanism allowing to cache the whole result of requests. This means, its possible to have
the generated html stored in that cache and further requests to that url served completely from that cache.
Unfortunately, its impossible to determine candidates for caching in advance, so its up to the developer to enable caching on them.
To enable caching on a function, decorate that function with <code class="xref py py-func docutils literal"><span class="pre">enableCache()</span></code> from server.cache.</p>
<div class="highlight-python"><div class="highlight"><pre>from server.cache import *
(..)

   @enableCache( urls=[&quot;/page/view&quot;, &quot;/xml/page/view&quot;],
                 userSensitive=False,
                 languageSensitive=True,
                 evaluatedArgs=[&quot;id&quot;],
                 maxCacheTime=60*60*24 )
   def view( self, id, *args, **kwargs ):
 (...)
</pre></div>
</div>
<p>This decorator takes several arguments, specifying how caching should happen.</p>
<blockquote>
<div><ul>
<li><dl class="first docutils">
<dt>urls: A list of urls for the decorated function, for which the caching should happen. As a function</dt>
<dd><p class="first last">can be reachable under several different urls (f.e. with different renders), its required to list the
urls which should be cached. In the example above, caching is enabled for the default render (usually jinja2)
and the xml-render. Its emph{not} enabled for other renders (like the admin-interface <a href="#id1"><span class="problematic" id="id2">``</span></a>/admin/page/view&#8217;&#8216;).
.. WARNING:: Never enable caching the admin! It will break things!</p>
</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt>userSensitive: If true, signals that the result of the decorated function depends on the currently logged-in user.</dt>
<dd><p class="first last">If False, the result is cached once and served to everyone, regardless if its a guest session or a known user.</p>
</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt>languageSensitive: If true, signals that the result of the decorated function might got translated. If True,</dt>
<dd><p class="first last">one result for each language will be cached and served. If False, it will serve the same cached content, regardless
of the language set for the current session.</p>
</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt>evaluatedArgs: List of keyword-arguments having influence to the output generated by</dt>
<dd><p class="first last">that function. This list emph{must} be complete! Parameters not named here are ignored!
emph{Warning:} Double-check this list! If f.e. the wrapped function generates a list of entries and
you miss the parameter <a href="#id3"><span class="problematic" id="id4">``</span></a>order&#8217;&#8217; here, it would be impossible to sort the list.
It would always have the ordering it had when the cache-entry was created.</p>
</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt>maxCacheTime: Specifies the maximum time an entry stays in the cache (in seconds).</dt>
<dd><p class="first">If None, the cache stay&#8217;s valid forever (until manually erased by calling flushCache).
.. NOTE:</p>
<div class="last highlight-python"><div class="highlight"><pre>It&#39;s not erased from the db after that time, but it won&#39;t be served anymore.
</pre></div>
</div>
</dd>
</dl>
</li>
</ul>
</div></blockquote>
<p>With this cache implementation, its possible to cache the result of arbitrary functions. They can be just called internally
(through note they must return a string) or exposed on the http-layer. But they <em>must not</em> depend or modify global variables.
If they depend on reading external / global variables, the cache is not able to detect changes in these variables, and will continue
to serve content generated from a request with a different global variables set. Also, its not able to detect changes made on the environment
by its wrapped function. If your application relies on changes made to these global variables by the wrapped function, don&#8217;t use the cache; it won&#8217;t
reply such changes. The only exception is setting the content-type header. If your function sets that header to indicate it will serve a non-html
content, the cache will indicate that content-type if it serves a cached result.</p>
<div class="section" id="module-server.cache">
<span id="server-cache-a-request-cache"></span><h2>server.cache - A Request Cache<a class="headerlink" href="#module-server.cache" title="Permalink to this headline">¶</a></h2>
<dl class="function">
<dt id="server.cache.enableCache">
<code class="descclassname">server.cache.</code><code class="descname">enableCache</code><span class="sig-paren">(</span><em>urls</em>, <em>userSensitive=0</em>, <em>languageSensitive=False</em>, <em>evaluatedArgs=[]</em>, <em>maxCacheTime=None</em><span class="sig-paren">)</span><a class="headerlink" href="#server.cache.enableCache" title="Permalink to this definition">¶</a></dt>
<dd><p>Decorator to mark a function cacheable.
Only functions decorated with enableCache are considered cacheable; 
ViUR will never ever cache the result of a user-defined function otherwise.
Warning: It&#8217;s not possible to cache the result of a function relying on reading/modifying
the environment (ie. setting custom http-headers). The only exception is the content-type header.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>urls</strong> (<em>List</em>) &#8211; A list of urls for this function, for which the cache should be enabled.
A function can have several urls (eg. /page/view or /pdf/page/view), and it
might should not be cached under all urls (eg. /admin/page/view).</li>
<li><strong>userSensitive</strong> (<em>Int</em>) &#8211; Signals wherever the output of f depends on the current user.
0 means independent of wherever the user is a guest or known, all will get the same content.
1 means cache only for guests, no cache will be performed if the user is logged-in.
2 means cache in two groups, one for guests and one for all users
3 will cache the result of that function for each individual users separately.</li>
<li><strong>languageSensitive</strong> (<em>Bool</em>) &#8211; If true, signals that the output of f might got translated.
If true, the result of that function is cached separately for each language.</li>
<li><strong>evaluatedArgs</strong> (<em>List</em>) &#8211; List of keyword-arguments having influence to the output generated by
that function. This list <em>must</em> be complete! Parameters not named here are ignored!
Warning: Double-check this list! F.e. if that function generates a list of entries and
you miss the parameter &#8220;order&#8221; here, it would be impossible to sort the list.
It would always have the ordering it had when the cache-entry was created.</li>
<li><strong>maxCacheTime</strong> (<em>Int or None</em>) &#8211; Specifies the maximum time an entry stays in the cache in seconds.
Note: Its not erased from the db after that time, but it won&#8217;t be served anymore.
If None, the cache stays valid forever (until manually erased by calling flushCache.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="server.cache.flushCache">
<code class="descclassname">server.cache.</code><code class="descname">flushCache</code><span class="sig-paren">(</span><em>prefix='/*'</em><span class="sig-paren">)</span><a class="headerlink" href="#server.cache.flushCache" title="Permalink to this definition">¶</a></dt>
<dd><p>Flushes the cache. Its possible the flush only a part of the cache by specifying
the path-prefix.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>prefix</strong> (<em>String</em>) &#8211; Path or prefix that should be flushed.</td>
</tr>
</tbody>
</table>
<dl class="docutils">
<dt>Examples:</dt>
<dd><ul class="first last simple">
<li>&#8220;/&#8221; would flush the main page (and only that),</li>
<li>&#8220;/<em>&#8221; everything from the cache, &#8220;/page/</em>&#8221; everything from the page-module (default render),</li>
<li>and &#8220;/page/view/<a href="#id5"><span class="problematic" id="id6">*</span></a>&#8221; only that specific subset of the page-module.</li>
</ul>
</dd>
</dl>
</dd></dl>

</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
            <p class="logo"><a href="index.html">
              <img class="logo" src="_static/viur.png" alt="Logo"/>
            </a></p>
  <h3><a href="index.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">Cache</a><ul>
<li><a class="reference internal" href="#module-server.cache">server.cache - A Request Cache</a></li>
</ul>
</li>
</ul>
<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="index.html">Documentation overview</a><ul>
      <li>Previous: <a href="server_api.html" title="previous chapter">server</a></li>
      <li>Next: <a href="config.html" title="next chapter">Configuration</a></li>
  </ul></li>
</ul>
</div>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="_sources/cache.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>

    <script>
        
    $(document).ready(function() {
        $('#popuplogin').click(function(e) {
               e.stopPropagation();
        });
    });
    
    
        $(document).ready(function () {
            $('#hamburgericon').click(function () {
                $(".sphinxsidebarwrapper").fadeIn(100);
                $("#fcside").fadeIn(100);
                $("body").css({ overflow: 'hidden' });
            });
        });
    
        $(document).ready(function () {
            $('#fcside').click(function () {
                $("body").css({ overflow: 'inherit' });
                $(".sphinxsidebarwrapper").fadeOut(100);
                $("#fcside").fadeOut(100);
            });
        });
        
            
        var thescroll=0;
        var scrolling =false;

    function scrolleventhandler (e) {

        if( thescroll > $(window).scrollTop()){
            scrolldir=-1;
        }else{
            scrolldir=1;
        }
        thescroll=$(window).scrollTop();
        wh=parseInt($("body").css("height").replace("px", ""))

        if (scrolldir>0) {
            $('.logo').addClass("is-scrolled");
            $('.is2').addClass("is-scrolled2");
            $('.is3').addClass("is-scrolled3");
            $('.is4').addClass("is-scrolled4");
            $('.is5').addClass("is-scrolled5");
            $('.viur').addClass("is-scrolled6");
            $('.sphinxsidebarwrapper').addClass("is-scrolled7");
            
        } else {
            $('.logo').removeClass("is-scrolled");
            $('.is2').removeClass("is-scrolled2");
            $('.is3').removeClass("is-scrolled3");
            $('.is4').removeClass("is-scrolled4");
            $('.is5').removeClass("is-scrolled5");
            $('.viur').removeClass("is-scrolled6");
            $('.sphinxsidebarwrapper').removeClass("is-scrolled7");
            
        }

    }
    
	$(window).scroll(scrolleventhandler);
	$(window).resize(scrolleventhandler);
    </script>
    
    
<header class="is2">
	<div class="binding">

		<div class="logo">
			<a href="#">
				<img class="is7" src="_static/viur.png" title="ViUR - Information System">
			</a>
			<h3 class="is3">Information System</h3>
		</div>

		<div class="topnav  no-mobil">
			<ul class="topnavlist is2">
				<li>
					<a class="viur is2 is4" href="#">
						<h2 class="is5">Download</h2>
						<span class="is3">Win | Mac | Linux</span>
					</a>
				</li>
				<li>
					<a class="community is2 is4" href="#">
						<h2 class="is5">Community</h2>
						<span class="is3">Start | Help | API</span>
					</a>
				</li>
				<li>
					<a class="develop is2 is4" href="#">
						<h2 class="is5">Development</h2>
						<span class="is3">Source Code | GIT</span>
					</a>
				</li>
				<li>
					<a class="docu is2 is4" href="#">
						<h2 class="not-mobile is5">Documentation</h2>
						<h2 class="not-desktop is5">Docs</h2>
						<span class="is3">Start | Help | API</span>
					</a>
				</li>
			</ul>
		</div>

	</div>
</header>
    
    <div id="fcside"></div>
    <div class="footer">
      &copy;2015, Mausbrand Informationssysteme GmbH.
      
      | <a href="/impressum">Impressum</a> |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 1.4a0+</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.7</a>
      
      |
      <a href="_sources/cache.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>